<!doctype html><html class="not-ready lg:text-base" lang=en dir=ltr><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Lalit Maganti</title><meta name=theme-color><meta name=description content="A personal blog"><meta name=author content="Lalit Maganti"><link rel="preload stylesheet" as=style href=https://lalitm.com/main.min.css><style>article{font-size:.9375rem!important;line-height:1.6!important}article header h1,article>header>h1,article>h1{font-size:1rem!important;line-height:1.6!important;font-weight:700!important}article h1 a{font-weight:700!important}main.prose>*:first-child,main.prose>*:first-child>*:first-child{margin-top:0!important}main{padding-top:1rem!important}html.dark{background-color:#282828}body{&::before { background-color:rgb(40,40,40); }}</style><link rel=preload as=image href=https://lalitm.com/theme.png><link rel=preload as=image href=https://lalitm.com/github.svg><link rel=preload as=image href=https://lalitm.com/linkedin.svg><link rel=preload as=image href=https://lalitm.com/rss.svg><link rel=icon href=https://lalitm.com/favicon.ico><link rel=apple-touch-icon href=https://lalitm.com/apple-touch-icon.png><meta name=generator content="Hugo 0.152.2"><link rel=preconnect href=https://www.googletagmanager.com crossorigin><link rel=dns-prefetch href=https://www.google-analytics.com><script async src="https://www.googletagmanager.com/gtag/js?id=G-CPF1NN7N28"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-CPF1NN7N28",{anonymize_ip:!0,cookie_flags:"SameSite=None;Secure"})</script><meta itemprop=name content="Lalit Maganti"><meta itemprop=datePublished content="2025-10-31T00:00:00+00:00"><meta itemprop=dateModified content="2025-10-31T00:00:00+00:00"><meta property="og:url" content="https://lalitm.com/"><meta property="og:site_name" content="Lalit Maganti"><meta property="og:title" content="Lalit Maganti"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="Lalit Maganti"><link rel=alternate type=application/rss+xml href=https://lalitm.com/index.xml title="Lalit Maganti"><link rel=canonical href=https://lalitm.com/></head><body class="text-black antialiased duration-200 ease-out [-webkit-tap-highlight-color:transparent] dark:text-white"><header class="mx-auto flex h-[4.5rem] max-w-(--w) px-8 whitespace-nowrap lg:justify-center"><div class="relative z-50 flex items-center ltr:mr-auto rtl:ml-auto"><a class="-translate-y-[1px] text-2xl font-medium" href=https://lalitm.com/>Lalit Maganti</a></div><div class="btn-menu relative z-50 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden ltr:-mr-8 rtl:-ml-8" role=button aria-label=Menu></div><script>const htmlClass=document.documentElement.classList;setTimeout(()=>{htmlClass.remove("not-ready")},10);const btnMenu=document.querySelector(".btn-menu");btnMenu.addEventListener("click",()=>{htmlClass.toggle("open")});const metaTheme=document.querySelector('meta[name="theme-color"]');metaTheme.setAttribute("content","#000"),htmlClass.add("dark")</script><div class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full flex-col justify-center bg-(--bg) pb-16 duration-200 select-none lg:static lg:h-auto lg:flex-row lg:bg-transparent! lg:pb-0 lg:transition-none"><nav class="lg:ml-12 lg:flex lg:flex-row lg:items-center lg:space-x-10 rtl:space-x-reverse"><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/page/about/>About</a><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/page/about/#subscribe>Subscribe</a></nav><nav class="mt-12 flex justify-center space-x-10 lg:mt-0 lg:items-center ltr:lg:ml-14 rtl:space-x-reverse rtl:lg:mr-14 dark:invert"><a class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./github.svg) href=https://github.com/LalitMaganti target=_blank rel=me>github</a>
<a class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./linkedin.svg) href=https://linkedin.com/in/lalit-maganti-18b73a9a target=_blank rel=me>linkedin</a>
<a class="h-7 w-7 text-[0px] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./rss.svg) href=https://lalitm.com/index.xml target=_blank rel=alternate>rss</a></nav></div></header><main class="prose prose-neutral dark:prose-invert relative mx-auto min-h-[calc(100vh-9rem)] max-w-(--w) px-8 pt-0 pb-16" style=margin-top:0><article class="mb-2 pb-2 mt-2 pb-2"><h1 class="!mt-1 !mb-1 !text-base !font-bold"><a href=https://lalitm.com/perfetto-swiss-army-knife/ class="!text-black dark:!text-white !no-underline hover:!underline">Perfetto: Swiss Army Knife for Linux Client Tracing</a></h1><time class="block text-xs" style=margin-bottom:.5rem;opacity:.6>Oct 31, 2025</time><div><p>I gave a talk at the <a href=https://tracingsummit.org/>2025 Tracing Summit</a> last month titled &ldquo;<a href=https://cfp.tracingsummit.org/ts2025/talk/TKVU8W/>Perfetto: The Swiss Army Knife of Linux Client/Embedded Tracing</a>&rdquo;. My goal in this talk was to show how Linux kernel, systems and embedded developers can use <a href=https://docs.perfetto.dev>Perfetto</a> when debugging and root-causing performance issues in their respective domains. Even though the Perfetto UI is primarily built for viewing <a href=https://perfetto.dev/docs/#why-would-you-use-perfetto->Android or Chrome traces</a>, it is a flexible tool and can be used in many other ways!</p><p>The talk was recorded and is available on <a href="https://www.youtube.com/watch?v=VzTwul2Qb3g">YouTube</a>. Taking inspiration from <a href=https://simonwillison.net/>Simon Willison</a>, this post is an <a href=https://simonwillison.net/2023/Aug/6/annotated-presentations/>annotated presentation</a> containing my slides and detailed notes on them. The talk also has a lot of UI demos: for these, I&rsquo;ll have a screenshot but also a link to the relevant part of the video (videos are unbeatable for UI!).</p><iframe width=693 height=390 src=https://www.youtube.com/embed/VzTwul2Qb3g title="TS2025 - Perfetto: The Swiss Army Knife of Linux Client/Embedded Tracing" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy=strict-origin-when-cross-origin allowfullscreen></iframe><hr><p>First, what is Perfetto? Perfetto is fundamentally a suite of tools: it&rsquo;s not just one thing but a bunch of different tools working together to help you debug and root-cause problems. This diagram shows how everything fits together, with the core parts of the Perfetto project in the center.</p><center><p><img src=/img/perfetto-swiss-army-03.jpg alt="diagram of all the pieces of Perfetto, Recording tools, protobuf format, trace processor, Perfetto UI, Python API, Format converters. Chrome JSON, Other profiling formats"></p></center><p>The recording tools for Perfetto consist of 1) an <a href=https://perfetto.dev/docs/getting-started/in-app-tracing>SDK for C++ apps</a> 2) a <a href=https://perfetto.dev/docs/getting-started/system-tracing>daemon</a> that can collect data from ftrace, /proc, /sys, and various kernel interfaces 3) another <a href=https://perfetto.dev/docs/concepts/service-model>daemon</a> that amalgamates trace data from multiple processes into a single trace file. These tools all speak the Perfetto <a href=https://perfetto.dev/docs/getting-started/converting>protobuf format</a>, a high-performance trace format designed to be very efficient to write but not to analyze or consume directly.</p><p>That&rsquo;s where the <a href=https://perfetto.dev/docs/analysis/trace-processor>trace processor</a> comes in. It&rsquo;s a C++ library that parses the protobuf format, but also a bunch of other widely used trace formats. It exposes this data via an SQL query interface to any embedding program including <a href=https://perfetto.dev/docs/visualization/perfetto-ui>Perfetto UI</a> (which is what most of this talk is about) and also to the <a href=https://perfetto.dev/docs/analysis/trace-processor-python>Python API</a> if you want to do ad-hoc scripting or analysis in Python.</p><p>There are also very common tracing/profiling formats used by the Linux community: perf.data, ftrace text format, Firefox profiler format, and many others. Perfetto <a href=https://perfetto.dev/docs/getting-started/other-formats>supports</a> quite a few of those directly. There&rsquo;s also the Chrome JSON format (AKA the <a href="https://docs.google.com/document/d/1CvAClvFfyA5R-PhYUmn5OOQtYMH4h6I0nSsKchNAySU/preview?tab=t.0">Trace Event Format</a>) which is a simpler interchange format. It&rsquo;s not the most efficient to read or write, but it does the job for a lot of use cases.</p><p>Often people write <a href=https://perfetto.dev/docs/getting-started/converting>converters</a>. They have their own tracing format, maybe proprietary, maybe open source but something we don&rsquo;t know about, and it&rsquo;s very common that people convert to one of the formats we understand, most commonly our protobuf or Chrome JSON formats.</p><center><p><img src=/img/perfetto-swiss-army-04.jpg alt="Slide showing Perfetto UI architecture with web-based trace visualizer features"></p></center><p>The <a href=https://perfetto.dev/docs/visualization/perfetto-ui>Perfetto UI</a> is fundamentally a web-based trace visualizer, combining timeline visualization, user-driven selection/aggregation, and SQL queries all in one interface. Because it has the trace processor as a backend, it works with a bunch of different trace formats.</p><p>It&rsquo;s very important to note that even though the Perfetto UI is web-based, everything happens inside your browser and trace data never leaves your system. You can even <a href=https://perfetto.dev/docs/contributing/ui-getting-started>build it</a> and host it yourself on any static server: we&rsquo;ve made it extremely easy to do so!</p><p>At the start of 2025, we actually moved our whole development to GitHub. In the past, we used to develop on Android and GitHub was just a mirror. That&rsquo;s no longer the case, GitHub is actually where we develop and take pull requests.</p><center><p><img src=/img/perfetto-swiss-army-05.jpg alt="Slide introducing the fractal renderer demo program with Vulkan and multi-threading"></p></center><p>Most of this talk, I&rsquo;m going to spend actually showing you how you can use the Perfetto UI to debug performance issues on Linux. I don&rsquo;t want to show you an Android trace which needs a lot of context about how the Android system works and so you think, &ldquo;oh, that was cool, but I didn&rsquo;t really understand what was happening.&rdquo;</p><p>So to make this talk more approachable, I wrote a <a href=https://github.com/LalitMaganti/fractal-renderer-vk>straightforward demo program</a> you can look at yourself! So it&rsquo;s obviously not a production system but I&rsquo;ve tried to make it as representative of the sort of issues we use Perfetto for every day.</p><p>It&rsquo;s a Rust program which generates a Julia set and visualizes it over time. The technologies I used: <a href=https://vulkano.rs/>Vulkan</a>, GPU rendering and also multi-threaded CPU computation. So how it works is that computation of various parameters is happening on background threads, and then that&rsquo;s being passed to the main thread for rendering.</p><p>And then, for demonstration purposes, there is a performance bug; rendering should run at 60 FPS, but every so often, the frame rate drops dramatically. Here&rsquo;s what that looks like:</p><center><p><img src=/img/test.avif alt="Animated visualization of Julia set fractal renderer showing frame rate drops"></p></center><p>The code is on <a href=https://github.com/LalitMaganti/fractal-renderer-vk>GitHub</a> and if you&rsquo;re interested in following along. The traces are there as well - you don&rsquo;t have to collect the traces yourself, but you can if you want. All the instructions and information is in the README.</p><div style=margin-top:1rem;margin-bottom:1rem><a href=https://lalitm.com/perfetto-swiss-army-knife/ class="text-sm opacity-60 hover:opacity-100 hover:underline">Continue reading →</a></div></div></article><hr style="border:0;border-top:1px solid rgba(128,128,128,.3);margin-top:1rem;margin-bottom:2rem"><article class="mb-2 pb-2 mt-2 pb-2"><h1 class="!mt-1 !mb-1 !text-base !font-bold"><a href=https://lalitm.com/til-public-file-hosting-with-0x0-st/ class="!text-black dark:!text-white !no-underline hover:!underline">TIL: Public File Hosting with 0x0.st</a></h1><time class="block text-xs" style=margin-bottom:.5rem;opacity:.6>Oct 25, 2025</time><div><p>Sometimes you run into a truly inspirational piece of software that it&rsquo;s a wonder even exists. I found <a href=https://0x0.st/>0x0.st</a> recently and it very much falls into this bucket.</p><p>It&rsquo;s essentially a simple, no-account, temporary file hosting site where you can just upload a file using a simple HTTP POST and the site will host it for you for between 30 days and 1 year depending on the size of the file. Uploading a file is as simple as:</p><pre tabindex=0><code>curl -F &#39;file=@yourfile.ext&#39; https://0x0.st
</code></pre><p>and you&rsquo;ll get back a URL that you can share or use in the future.</p><p>I thought all the services like this had long since disappeared especially in the age of increasing scrutiny by government of content that websites host. It turns out though that from this discussion on <a href="https://news.ycombinator.com/item?id=35491520">HN</a>, there are actually a bunch of similar services (transfer.sh, bashupload.com, chunk.io) but 0x0.st was the only one which I was able to access without an error.</p><div style=margin-top:1rem;margin-bottom:1rem><a href=https://lalitm.com/til-public-file-hosting-with-0x0-st/ class="text-sm opacity-60 hover:opacity-100 hover:underline">Continue reading →</a></div></div></article><hr style="border:0;border-top:1px solid rgba(128,128,128,.3);margin-top:1rem;margin-bottom:2rem"><article class="mb-2 pb-2 mt-2 pb-2"><h1 class="!mt-1 !mb-1 !text-base !font-bold"><a href=https://lalitm.com/til-will-change-and-isolation-css-properties/ class="!text-black dark:!text-white !no-underline hover:!underline">TIL: `will-change` and `isolation` CSS properties</a></h1><time class="block text-xs" style=margin-bottom:.5rem;opacity:.6>Oct 24, 2025</time><div><p>The Perfetto UI is a fascinating project to work on because it often faces performance problems which you wouldn&rsquo;t see in more &ldquo;normal&rdquo; webapps. I learn about all sorts of weird web features by reviewing PRs for the UI.</p><p>Two such features I just learned about:</p><ul><li><a href=https://developer.mozilla.org/en-US/docs/Web/CSS/will-change>will-change</a> (<a href=https://github.com/google/perfetto/pull/3350/files#diff-c57fa71e0c282ce81f65b10226043f6d89c4105afd3f5ec5813b8d9d5e034101R128>PR</a>): a hint, to be used sparingly, to tell the browser that a certain property of a DOM element will change in the near future.</li><li><a href=https://developer.mozilla.org/en-US/docs/Web/CSS/isolation>isolation</a> (<em><a href=https://github.com/google/perfetto/pull/3381/files#diff-c57fa71e0c282ce81f65b10226043f6d89c4105afd3f5ec5813b8d9d5e034101R119>PR</a></em>):
I feel MDN didn&rsquo;t do a great job of explaining so I asked Claude which gave a much more useful answer:<blockquote><p>isolation is a CSS property that creates a new stacking context for an element. Think of a stacking context as a self-contained z-index universe. Elements within one stacking context can layer on top of each other, but their z-index values only matter relative to siblings within that same context.</p></blockquote></li></ul></div></article><hr style="border:0;border-top:1px solid rgba(128,128,128,.3);margin-top:1rem;margin-bottom:2rem"><article class="mb-2 pb-2 mt-2 pb-2"><h1 class="!mt-1 !mb-1 !text-base !font-bold"><a href=https://lalitm.com/til-the-documentation-system-divio/ class="!text-black dark:!text-white !no-underline hover:!underline">TIL: The Documentation System (Divio)</a></h1><time class="block text-xs" style=margin-bottom:.5rem;opacity:.6>Oct 19, 2025</time><div><p>The Perfetto team spent a lot of time earlier this year rewriting our documentation to be more useful for the average developer. We struggled a lot to figure out &ldquo;what is the best way to structure our documentation&rdquo;.</p><p>When reading <a href=https://rakhim.exotext.com/examples-are-the-best-documentation>Examples are the best documentation</a> today, I came across <a href=https://docs.divio.com/documentation-system/>The Documentation System</a>, an approach to structuring developer documentation. Reading through it, I couldn&rsquo;t help but marvel at how clear and concisely it laid out the ideas we were struggling to come up with from first principles.</p><p>Specifically, I really like how it breaks down documentation into four quadrants:</p><ol><li><a href=https://docs.divio.com/documentation-system/tutorials/><strong>Tutorials</strong></a>: take your user through a series of steps to complete some task with your project.</li><li><a href=https://docs.divio.com/documentation-system/how-to-guides/><strong>How-to guides</strong></a>: solve a real world problem with your project.</li><li><a href=https://docs.divio.com/documentation-system/reference/><strong>Reference guides</strong></a>: give technical explanations of how things work.</li><li><a href=https://docs.divio.com/documentation-system/explanation/><strong>Explanations</strong></a>: clarify a particular topic or area and how the project fits into the bigger tech landscape.</li></ol><p>I think we got <em>most</em> of this right in our documentation rewrite but we definitely muddled some of these areas together, making our pages less clear than they could be. I plan on spending some time later this year correcting our docs to match this system closer.</p></div></article><hr style="border:0;border-top:1px solid rgba(128,128,128,.3);margin-top:1rem;margin-bottom:2rem"><article class="mb-2 pb-2 mt-2 pb-2"><h1 class="!mt-1 !mb-1 !text-base !font-bold"><a href=https://lalitm.com/perfetto-oss-company-prio/ class="!text-black dark:!text-white !no-underline hover:!underline">On Perfetto, Open Source, and Company Priorities</a></h1><time class="block text-xs" style=margin-bottom:.5rem;opacity:.6>Oct 17, 2025</time><div><p><em>Discussed on lobste.rs <a href=https://lobste.rs/s/chaivl/on_perfetto_open_source_company>here</a>.</em></p><p>I recently stumbled across
<a href=https://lobste.rs/s/fl7ly9/traceboot_precise_lightweight_tracing>this post on lobste.rs</a>
about a project called
<a href=https://codeberg.org/SpecialSnowflake/traceboot>traceboot</a> which allows
visualizing the Linux boot process using lightweight ftrace events and Perfetto.
The author had
<a href=https://codeberg.org/SpecialSnowflake/traceboot#woes-with-a-rant-and-ideas-last-paragraph-of-this-section>some commentary</a>
about their experience trying to order tracks in Perfetto:</p><blockquote><p>Ordering tracks with perfetto has been ridiculously complicated. It has taken
the majority of the time of this project! Upstream&rsquo;s answers are basically
that the main user is Android (Perfetto is a Google project) so others come
second if at all. While I get the reasons to do so, I read that as a caution
against depending on it as a third-party. Google is notorious for (&mldr;)
completely killing projects</p></blockquote><p>Honestly? All of these points are right:</p><ul><li>It is really unfortunate that doing something so simple took so much effort.</li><li>It&rsquo;s true that external users are supported at a lower priority than Android
users.</li><li>It&rsquo;s also the case that Google has historically wound down projects when
priorities shift</li></ul><p>The good news is that we just
<a href=https://github.com/google/perfetto/pull/3273>landed</a> support for trace
writers to specify explicitly how traces should be ordered with the JSON format
in Perfetto without any extreme workarounds! This feature is already available on
the &ldquo;Canary&rdquo; UI channel and on &ldquo;Stable&rdquo; within 3-4 weeks.</p><div style=margin-top:1rem;margin-bottom:1rem><a href=https://lalitm.com/perfetto-oss-company-prio/ class="text-sm opacity-60 hover:opacity-100 hover:underline">Continue reading →</a></div></div></article><hr style="border:0;border-top:1px solid rgba(128,128,128,.3);margin-top:1rem;margin-bottom:2rem"><article class="mb-2 pb-2 mt-2 pb-2"><h1 class="!mt-1 !mb-1 !text-base !font-bold"><a href=https://lalitm.com/writing-tools-for-claude-code/ class="!text-black dark:!text-white !no-underline hover:!underline">What Makes a Good Tool for Claude Code</a></h1><time class="block text-xs" style=margin-bottom:.5rem;opacity:.6>Oct 12, 2025</time><div><p>I&rsquo;ve been using Claude Code extensively for personal projects, and similar AI
coding tools at work. Recently I came across
<a href=https://www.alephic.com/writing/the-magic-of-claude-code>this excellent blog post</a>
that resonated with a lot of my experience.</p><p>One part stuck with me though: Noah emphasizes that tools fail with LLMs when
they&rsquo;re &ldquo;overly complex,&rdquo; with the Unix philosophy being particularly
well-suited for tool calling. But then I thought about <code>git</code>.</p><p>Git breaks the Unix philosophy completely. It&rsquo;s sprawling, stateful, and
complex. And yet Claude Code handles it effortlessly. It composes commands that,
even after 10+ years of daily git usage, I wouldn&rsquo;t think to use. It handles
rebasing, cherry-picking, complex resets—stuff that trips up experienced
developers regularly.</p><p>So if simplicity and the Unix philosophy aren&rsquo;t the whole story, what else
matters?</p><p>I’ve come up with three “hallmarks” of a good tool for tool calling with LLMs.</p><p><strong>1. It’s been around for a long time and/or is used by lots of people</strong></p><div style=margin-top:1rem;margin-bottom:1rem><a href=https://lalitm.com/writing-tools-for-claude-code/ class="text-sm opacity-60 hover:opacity-100 hover:underline">Continue reading →</a></div></div></article><hr style="border:0;border-top:1px solid rgba(128,128,128,.3);margin-top:1rem;margin-bottom:2rem"><article class="mb-2 pb-2 mt-2 pb-2"><h1 class="!mt-1 !mb-1 !text-base !font-bold"><a href=https://lalitm.com/llm-motivation-via-emotions/ class="!text-black dark:!text-white !no-underline hover:!underline">Harnessing Frustration: Using LLMs to Overcome Activation Energy</a></h1><time class="block text-xs" style=margin-bottom:.5rem;opacity:.6>Jul 14, 2025</time><div><p>One of my biggest weaknesses as a software engineer is procrastination when
facing a new project. When the scope is unclear, I have a tendency to wait until
I feel I&rsquo;ve &ldquo;felt out&rdquo; the problem to start doing anything. I know I&rsquo;ll feel
better and work much faster when I get &ldquo;stuck in&rdquo; but I still struggle with that
first step, overcoming the &ldquo;activation energy&rdquo; required to engage with the
details.</p><p>LLMs have been a game-changer for me in this respect: I can just throw a couple
of sentences at them with the shape of the problem. This leads to one of two
outcomes:</p><ol><li>The LLM comes up with a good solution, usually in a slightly different way
than what I was thinking. I realize &ldquo;oh wow the solution is much simpler than
I thought&rdquo;. Straight away I start thinking about the consequences of
implementing and improving what the LLM suggested.</li><li>The LLM comes up with a solution that I intuitively recognize as &ldquo;wrong&rdquo;. My
immediate reaction is frustration (&ldquo;How could it get it so wrong&rdquo;) which
leads me to go back and forth with the model, explaining to it why its
solution could not <em>possibly</em> work. But in the process of arguing with the
model, my brain is churning away and generating variations or different
approaches that <em>could</em> work. After a while, even if the AI is still on the
wrong track, the debate will trigger a moment of inspiration where suddenly
the solution will come to me. I&rsquo;ll excitedly start up a new conversation and
start working through it with the model.</li></ol><p>The key is the emotional reaction I have immediately to the LLM&rsquo;s response,
either <strong>excitement or frustration</strong>. By harnessing this immediate feedback
loop, I get my brain out of its passive, procrastination mode. It&rsquo;s almost like
a jolt: either I&rsquo;m thrilled because it&rsquo;s simpler than I thought, or I&rsquo;m spurred
to action by the urge to correct a perceived &lsquo;wrong&rsquo; answer. This forces me to
engage with the problem in a meaningful way.</p><div style=margin-top:1rem;margin-bottom:1rem><a href=https://lalitm.com/llm-motivation-via-emotions/ class="text-sm opacity-60 hover:opacity-100 hover:underline">Continue reading →</a></div></div></article><hr style="border:0;border-top:1px solid rgba(128,128,128,.3);margin-top:1rem;margin-bottom:2rem"><article class="mb-2 pb-2 mt-2 pb-2"><h1 class="!mt-1 !mb-1 !text-base !font-bold"><a href=https://lalitm.com/hw-encoding-raspi/ class="!text-black dark:!text-white !no-underline hover:!underline">V4L2 and Hardware Encoding on the Raspberry Pi</a></h1><time class="block text-xs" style=margin-bottom:.5rem;opacity:.6>Feb 1, 2021</time><div><p><strong>TLDR</strong>: Explain how the V4L2 M2M API works through the use-case of
implementing hardware video encoding on the Raspberry Pi. This knowledge is
generally useful as V4L2 is the de-facto generic API for hardware decoding and
encoding on Linux.</p><p><strong>Background</strong></p><p>My journey started at
<a href="https://www.youtube.com/watch?v=CyEpshm16HY&amp;t=139s">this video</a> on the
excellent
<a href=https://www.youtube.com/channel/UCp3yVOm6A55nx65STpm3tXQ>Craft Computing</a>
YouTube channel which showed how to setup TinyPilot, a Python app for KVM over
IP which runs on a Raspberry Pi. Behind the scenes, TinyPilot uses
<a href=https://github.com/pikvm/ustreamer>ustreamer</a> to read frames from a HDMI
capture card and either exposes it over HTTP or writes it to shared memory.
Along with the MJPEG output, support was recently added for encoding video using
H264.</p><p>Even after messing with the source code, I could not get the H264 encoding
working on my Pi running 64-bit Ubuntu with an error message of
<code>Can't create MMAL wrapper</code>. Digging further, I ran into some insurmountable
roadblocks with the approach taken by ustreamer and discovered the complex state
of hardware encoding on the Pi.</p><div style=margin-top:1rem;margin-bottom:1rem><a href=https://lalitm.com/hw-encoding-raspi/ class="text-sm opacity-60 hover:opacity-100 hover:underline">Continue reading →</a></div></div></article></main><footer class="mx-auto flex h-[4.5rem] max-w-(--w) items-center px-8 text-xs tracking-wider uppercase opacity-60"><div class=mr-auto>&copy;2025
<a class=link href=https://lalitm.com/>Lalit Maganti</a></div><a class="link mx-6" href=https://gohugo.io/ rel=noopener target=_blank>powered by hugo️️</a>️
<a class=link href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>hugo-paper</a></footer></body></html>